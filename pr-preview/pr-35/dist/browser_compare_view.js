var compare_view;(()=>{"use strict";var e,t,n={d:(e,t)=>{for(var c in t)n.o(t,c)&&!n.o(e,c)&&Object.defineProperty(e,c,{enumerable:!0,get:t[c]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},c={};n.r(c),n.d(c,{load:()=>C,load_new_imgs:()=>d}),function(e){e[void 0]="undefined",e.horizontal="horizontal",e.vertical="vertical",e.circle="circle"}(e||(e={})),function(e){e[e.none=0]="none",e[e.revolve_imgs=1]="revolve_imgs",e[e.update_imgs=2]="update_imgs",e[e.change_mode=3]="change_mode",e[e.update_circle=4]="update_circle",e[e.remove_circle=5]="remove_circle",e[e.start_slider_move=6]="start_slider_move",e[e.possible_instant_slide=7]="possible_instant_slide",e[e.update_slider=8]="update_slider"}(t||(t={}));const o={start_mode:e.circle,circumference_fraction:.005,circle_size:void 0,circle_fraction:.2,show_circle:!0,revolve_imgs_on_click:!0,slider_fraction:.01,slider_time:400,rate_function:function(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2},start_slider_pos:.5,show_slider:!0};function i(e,t){return null!=e[t]?e[t]:o[t]}function a(e,t){e.canvas.width=t[0],e.canvas.height=t[1],e.width=e.canvas.width,e.height=e.canvas.height,function(e){let t=Math.max(e.canvas.width,e.canvas.height);e.circumference_thickness=t*i(e.cfg,"circumference_fraction"),e.circle_size=null!=e.cfg.circle_size?e.cfg.circle_size:t*i(e.cfg,"circle_fraction"),e.slider_thickness=t*i(e.cfg,"slider_fraction")}(e)}function r(e){var t,n;let c=null===(t=e[0])||void 0===t?void 0:t.element.width,o=null===(n=e[0])||void 0===n?void 0:n.element.height;for(let t of e)t.element.width==c&&t.element.height==o||console.log("Warning: images don't have the same resolution"),c=Math.max(c,t.element.width),o=Math.max(o,t.element.height);return[c,o]}function s(e,t){if(e.length<2)throw`image_urls must contain at least two images, not ${e.length}`;let n=[],c=0,o=e.length;for(let i=0;i<o;++i){let a={url:e[i],element:document.createElement("img"),label:`${i}`};n.push(a),a.element.onload=()=>{++c,c==o&&t(n,r(n))},a.element.src=a.url}}function l(e){return e.images.unshift(e.images.pop()),!0}function u(e){return e.images=e.new_images,a(e,e.new_image_resolution),!0}function d(e,n){s(n,((n,c)=>{e.new_images=n,e.images_len=n.length,e.new_image_resolution=c,I(e,t.update_imgs)}))}function _(t){var n;if(null!=t.ctrl_data)switch((n=t.ctrl_data).circle_check.checked=!1,n.horizontal_check.checked=!1,n.vertical_check.checked=!1,t.current_mode){case e.circle:t.ctrl_data.circle_check.checked=!0;break;case e.horizontal:t.ctrl_data.horizontal_check.checked=!0;break;case e.vertical:t.ctrl_data.vertical_check.checked=!0;break;default:throw`unsupported mode: ${t.current_mode}`}}function h(e,n){return c=>{c.target.checked?(e.next_mode=n,I(e,t.change_mode)):_(e)}}function m(e,t){let n=e.canvas.getBoundingClientRect(),c=e.width/n.width,o=e.height/n.height;e.mouse_pos=[(t.clientX-n.left)*c,(t.clientY-n.top)*o]}function v(e){return e.render_circle=!0,e.canvas.style.cursor="none",!1}function g(e){return T(e,t.update_circle),e.canvas.style.cursor="default",!0}function p(e,t,n){e.ctx.beginPath(),e.ctx.arc(e.mouse_pos[0],e.mouse_pos[1],e.circle_size,t,n),n-t!=2*Math.PI&&e.ctx.lineTo(e.mouse_pos[0],e.mouse_pos[1]),e.ctx.closePath()}function f(e,t,n,c){var o;p(e,n,c),e.ctx.save(),e.ctx.clip(),e.ctx.drawImage(null===(o=e.images[t])||void 0===o?void 0:o.element,0,0,e.width,e.height),e.ctx.restore(),e.show_circle&&(p(e,n,c),e.ctx.strokeStyle="black",e.ctx.lineWidth=e.circumference_thickness,e.ctx.stroke())}function w(n,c){return I(n,t.update_slider),n.start_timestamp=c,n.start_pos=n.slider_pos,n.current_mode==e.horizontal?n.target_pos=n.mouse_pos[0]/n.width:n.target_pos=n.mouse_pos[1]/n.height,!0}function k(t,n){return t.held_down&&(t.current_mode==e.horizontal?t.target_pos=t.mouse_pos[0]/t.width:t.target_pos=t.mouse_pos[1]/t.height,t.start_pos=t.target_pos,t.slider_pos=t.target_pos),!0}function x(e,t){let n=(t-e.start_timestamp)/e.slider_time;return n=Math.min(Math.max(n,0),1),n=e.rate_function(n),e.slider_pos=(1-n)*e.start_pos+n*e.target_pos,e.slider_pos==e.target_pos}function b(n){switch(n.current_mode){case e.undefined:break;case e.circle:!function(e){e.canvas.onmousemove=null,e.canvas.onmouseleave=null,e.canvas.ontouchstart=null,e.canvas.onmousedown=null,e.canvas.onfocus=null,e.canvas.onblur=null,e.canvas.style.cursor="default",document.body.style.userSelect="text",e.touching=!1,I(e,t.remove_circle)}(n);break;case e.horizontal:case e.vertical:!function(e){e.canvas.onmousedown=null,e.canvas.onmouseup=null,document.onmouseup=null,e.canvas.onmouseup=null,e.canvas.onmousemove=null,e.canvas.onmouseenter=null,e.canvas.onmouseleave=null,e.canvas.onfocus=null,e.canvas.onblur=null,e.held_down=!1,e.canvas.style.cursor="default",document.body.style.userSelect="text"}(n);break;default:throw`unsupported mode: ${n.current_mode}`}}function y(n){switch(n.current_mode=n.next_mode,n.next_mode){case e.circle:!function(e){e.canvas.onmousemove=n=>{m(e,n),I(e,t.update_circle)},e.canvas.onmouseleave=()=>{I(e,t.remove_circle)},e.revolve_imgs_on_click&&(e.canvas.ontouchstart=()=>{e.touching=!0},e.canvas.onmousedown=()=>{e.touching||I(e,t.revolve_imgs)}),e.canvas.matches(":hover")&&I(e,t.update_circle),e.canvas.onfocus=()=>{document.body.style.userSelect="none"},e.canvas.onblur=()=>{document.body.style.userSelect="text",e.touching=!1}}(n);break;case e.horizontal:case e.vertical:!function(n){n.canvas.onmousedown=()=>{n.held_down=!0,I(n,t.start_slider_move)},n.canvas.onmouseup=()=>{n.held_down=!1},document.onmouseup=()=>{n.held_down=!1},n.canvas.onmousemove=e=>{m(n,e),I(n,t.possible_instant_slide)},n.current_mode==e.horizontal?n.canvas.onmouseenter=()=>{n.canvas.style.cursor="ew-resize"}:n.canvas.onmouseenter=()=>{n.canvas.style.cursor="ns-resize"},n.canvas.onmouseleave=()=>{n.canvas.style.cursor="default"},n.canvas.onfocus=()=>{document.body.style.userSelect="none"},n.canvas.onblur=()=>{document.body.style.userSelect="text"}}(n);break;default:throw`unsupported mode: ${n.current_mode}`}_(n)}function z(e){return b(e),y(e),!0}function M(n,c){!function(e,n){let c=[];for(;e.task_stack.length;){let o,i=e.task_stack.pop();switch(i){case t.none:o=!0;break;case t.change_mode:o=z(e);break;case t.revolve_imgs:o=l(e);break;case t.update_imgs:o=u(e);break;case t.update_circle:o=v(e);break;case t.remove_circle:o=g(e);break;case t.start_slider_move:o=w(e,n);break;case t.possible_instant_slide:o=k(e);break;case t.update_slider:o=x(e,n);break;default:throw`unknown task: ${i}`}o||c.push(i)}e.task_stack=c}(n,c),function(t){switch(t.current_mode){case e.circle:!function(e){var t;if(e.render_circle){e.ctx.clearRect(0,0,e.width,e.height),function(e){var t;e.ctx.beginPath(),e.ctx.arc(e.mouse_pos[0],e.mouse_pos[1],e.circle_size-1,0,2*Math.PI),e.ctx.lineTo(e.width,0),e.ctx.lineTo(0,0),e.ctx.lineTo(0,e.height),e.ctx.lineTo(e.width,e.height),e.ctx.lineTo(e.width,0),e.ctx.closePath(),e.ctx.save(),e.ctx.clip(),e.ctx.drawImage(null===(t=e.images[0])||void 0===t?void 0:t.element,0,0,e.width,e.height),e.ctx.restore()}(e);for(let t=1;t<e.images_len;++t)f(e,t,(t-1)*Math.PI*2/(e.images_len-1),t*Math.PI*2/(e.images_len-1))}else e.ctx.clearRect(0,0,e.width,e.height),e.ctx.drawImage(null===(t=e.images[0])||void 0===t?void 0:t.element,0,0,e.width,e.height);e.render_circle=!1}(t);break;case e.horizontal:case e.vertical:!function(t){var n;t.ctx.clearRect(0,0,t.width,t.height),t.ctx.drawImage(null===(n=t.images[0])||void 0===n?void 0:n.element,0,0,t.width,t.height),t.show_slider&&function(t){t.ctx.beginPath(),t.current_mode==e.horizontal?(t.ctx.moveTo(t.slider_pos*t.width,0),t.ctx.lineTo(t.slider_pos*t.width,t.height)):(t.ctx.moveTo(0,t.slider_pos*t.height),t.ctx.lineTo(t.width,t.slider_pos*t.height)),t.ctx.closePath(),t.ctx.strokeStyle="black",t.ctx.lineWidth=t.slider_thickness,t.ctx.stroke()}(t),function(t){var n;t.ctx.beginPath(),t.current_mode==e.horizontal?t.ctx.rect(t.slider_pos*t.width,0,t.width,t.height):t.ctx.rect(0,t.slider_pos*t.height,t.width,t.height),t.ctx.closePath(),t.ctx.save(),t.ctx.clip(),t.ctx.clearRect(0,0,t.width,t.height),t.ctx.drawImage(null===(n=t.images[1])||void 0===n?void 0:n.element,0,0,t.width,t.height),t.ctx.restore()}(t)}(t);break;default:throw`unsupported mode: ${t.current_mode}`}}(n),n.task_stack.length?P(n):n.next_update_queued=!1}function P(e){e.next_update_queued=!0,window.requestAnimationFrame((t=>{M(e,t)}))}function T(e,t){let n=e.task_stack.indexOf(t);-1!=n&&e.task_stack.splice(n,1)}function I(e,t){T(e,t),e.task_stack.push(t),function(e){e.next_update_queued||P(e)}(e)}function S(e,t,n){let c=document.createElement("input");c.type="checkbox",c.id=e;let o=document.createElement("label");o.innerHTML=t,o.htmlFor=c.id;let i=document.createElement("br");return n.appendChild(c),n.appendChild(o),n.appendChild(i),c}function $(e,t){let n=document.createElement("button");n.innerHTML=e;let c=document.createElement("br");return t.appendChild(n),t.appendChild(c),n}function C(n,c,o={},r=(()=>{})){let l=null!=o.controls_id?function(e,t=function(){let e="";for(let t=0;t<12;t++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(36*Math.random()));return e}()){let n=document.getElementById(e);if(null==n)throw`controls_id '${e}' isn't valid`;return{circle_check:S(`${t}_circle_button`,"Circle",n),horizontal_check:S(`${t}_horizontal_button`,"Horizontal",n),vertical_check:S(`${t}_vertical_button`,"Vertical",n),revolve_imgs_button:$("Revolve Images",n)}}(o.controls_id,o.key):void 0;!function(n,c,o={},r){!function(e){if("y"===e.dataset.in_use)throw`the canvas with the id '${e.id}' is already in use`;e.dataset.in_use="y"}(c.canvas),s(n,((n,s)=>{let l={cfg:o,images:n,images_len:n.length,new_images:[],new_image_resolution:[0,0],canvas:c.canvas,ctx:c,width:0,height:0,ctrl_data:void 0,mouse_pos:[0,0],held_down:!1,next_mode:i(o,"start_mode"),current_mode:e.undefined,task_stack:[],next_update_queued:!1,circumference_thickness:0,render_circle:!1,circle_size:0,show_circle:i(o,"show_circle"),revolve_imgs_on_click:i(o,"revolve_imgs_on_click"),touching:!1,slider_thickness:0,slider_pos:i(o,"start_slider_pos"),slider_time:i(o,"slider_time"),rate_function:i(o,"rate_function"),show_slider:i(o,"show_slider"),start_timestamp:0,start_pos:0,target_pos:0};a(l,s),null!=r&&r(l),I(l,t.change_mode)}))}(n,function(e){let t=document.getElementById(e),n=t.getContext("2d");return t.tabIndex=1,n}(c),o,(n=>{null!=l&&function(n,c){n.ctrl_data=c,c.circle_check.onclick=h(n,e.circle),c.horizontal_check.onclick=h(n,e.horizontal),c.vertical_check.onclick=h(n,e.vertical),c.revolve_imgs_button.onclick=()=>{I(n,t.revolve_imgs)}}(n,l),r(n)}))}compare_view=c})();